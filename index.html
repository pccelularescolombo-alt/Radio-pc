<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>R√°dio Online</title>

<!-- =====================================================
CSS
===================================================== -->
<style>

/* ===============================
RESET E BASE
================================ */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    background:#111;
    color:#fff;
    font-family:Arial, Helvetica, sans-serif;
    min-height:100vh;
    padding-top:70px;
    padding-bottom:120px;
}

/* ===============================
BARRA SUPERIOR FIXA
================================ */
.top-bar{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:70px;
    background:linear-gradient(90deg,#007bff,#ff7a00);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 20px;
    z-index:1000;
}

.top-bar img{
    height:40px;
    cursor:pointer;
}

/* ===============================
√ÅREA CENTRAL
================================ */
.center{
    max-width:1200px;
    margin:0 auto;
    text-align:center;
    padding:60px 20px;
}

/* ===============================
BARRA INFERIOR FIXA
================================ */
.bottom-bar{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    height:120px;
    background:linear-gradient(90deg,#007bff,#ff7a00);
    border-top:1px solid rgba(255,255,255,.15);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:1000;
}

/* ===============================
PLAYER WRAPPER
================================ */
.player-wrapper{
    width:100%;
    max-width:1400px; /* aumenta √°rea √∫til */
    display:flex;
    align-items:center;
    gap:22px;
    padding:0 25px;
}

/* ===============================
BOT√ïES
================================ */
.controls{
    display:flex;
    gap:10px;
}

.controls img{
    width:42px;
    height:42px;
    cursor:pointer;
    opacity:.7;
    transition:.2s;
}

.controls img:hover{
    opacity:1;
    transform:scale(1.1);
    filter:drop-shadow(0 0 6px #00c3ff);
}

/* ===============================
BARRAS (M√öSICA / G√äNERO)
================================ */
.track-bar{
    flex:1;
    background:#1b1b1b;
    border-radius:14px;
    padding:10px 14px;
    height:70px;
    display:flex;
    flex-direction:column;
    justify-content:center;
}

.track-info{
    display:flex;
    justify-content:space-between;
    font-size:13px;
    font-weight:500;
    opacity:.95;
}

.progress-container{
    position:relative;
    height:7px;
    background:#333;
    border-radius:6px;
    overflow:hidden;
}

.progress{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#00c3ff,#ff7a00);
}

.dot{
    position:absolute;
    top:50%;
    left:0%;
    width:12px;
    height:12px;
    background:#fff;
    border-radius:50%;
    transform:translate(-50%,-50%);
}

/* ===============================
LOGIN BOX
================================ */
#loginBox{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:#1c1c1c;
    padding:20px;
    border-radius:10px;
    display:none;
    flex-direction:column;
    gap:10px;
    z-index:2000;
}

#loginBox input{
    padding:10px;
    border:none;
    border-radius:6px;
}

#loginBox button{
    padding:10px;
    background:#ff7a00;
    border:none;
    color:#fff;
    border-radius:6px;
    cursor:pointer;
}
/* ===============================
RESPONSIVO
================================ */
@media(max-width:768px){
    .player-wrapper{
        flex-direction:column;
        gap:14px;
    }

    .controls{
        order:1;
    }

    .track-bar{
        width:100%;
    }
}

/* ===============================
PARTE 13 ‚Äì CSS PAINEL DE G√äNEROS
================================ */
#genrePanel{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.75);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:3000;
}

.genre-box{
    background:#1c1c1c;
    padding:20px;
    border-radius:10px; /* igual ao login */
    width:90%;
    max-width:280px;   /* mesmo padr√£o do login */
    display:flex;
    flex-direction:column;
    gap:10px;
    text-align:center;
}

/* Bot√µes iguais ao login */
#genrePanel button{
    padding:10px;
    background:#ff7a00;
    border:none;
    color:#fff;
    border-radius:6px;
    cursor:pointer;
    transition:.2s;
}

#genrePanel button:hover{
    opacity:.85;
}

#genreList{
    display:flex;
    flex-direction:column;
    gap:6px;
    max-height:220px;
    overflow-y:auto;
}

#genreList button{
    background:#2a2a2a;
    color:#fff;
    padding:10px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    text-align:left;
    transition:.2s;
}

#genreList button:hover{
    background:#ff7a00;
}

/* ===============================
LOADING PANEL
================================ */

#loadingPanel{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.85);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:5000;
}

.loading-box{
    background:#1c1c1c;
    padding:20px;
    border-radius:10px;
    width:90%;
    max-width:300px;
    display:flex;
    flex-direction:column;
    gap:12px;
    text-align:center;
}

.loading-item{
    display:flex;
    justify-content:space-between;
    font-size:14px;
}

.loading-bar{
    height:8px;
    background:#333;
    border-radius:6px;
    overflow:hidden;
}

#loadingProgress{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#00c3ff,#ff7a00);
}

#loadingPercent{
    font-size:14px;
}

/* ===============================
ANIMA√á√ïES DOS BOT√ïES
================================ */
.controls img{
    transition:
        transform .2s ease,
        filter .2s ease,
        opacity .2s ease;
}

.controls img:hover{
    transform:scale(1.15);
    filter:drop-shadow(0 0 8px rgba(0,195,255,.8));
    opacity:1;
}

.controls img.active{
    filter:drop-shadow(0 0 10px rgba(255,122,0,.9));
    transform:scale(1.15);
    opacity:1;
}

.controls img:active{
    transform:scale(0.95);
}

</style>
</head>
<!-- ===============================
PAINEL DE G√äNEROS
================================ -->
<div id="genrePanel" style="display:none">
    <div class="genre-box">
        <h3>Selecionar G√™nero</h3>

        <div id="genreList"></div>

        <button onclick="autoGenre()">üîÄ Sele√ß√£o Autom√°tica</button>
        <button onclick="closeGenrePanel()">‚ùå Fechar</button>
    </div>
</div>

<body>

<!-- =====================================================
HTML
===================================================== -->

<!-- ===============================
LOADING PANEL
================================ -->
<div id="loadingPanel">
    <div class="loading-box">
        <h3>Preparando R√°dio...</h3>

        <div id="loadingList"></div>

        <div class="loading-bar">
            <div id="loadingProgress"></div>
        </div>

        <div id="loadingPercent">0%</div>
    </div>
</div>

<div class="top-bar">
    <img src="imagens/logo.png" alt="Logo">
    <img id="loginIcon" src="icon/login.png" onclick="toggleLogin()">
</div>

<div class="center">
    <h1>R√°dio Online</h1>
    <p>Pinheirinho Celulares</p>
</div>

<div class="bottom-bar">
    <div class="player-wrapper">

        <div class="controls">
            <img id="playBtn" src="icon/play.png" onclick="togglePlay()">
            <img id="nextBtn" src="icon/proximo.png" onclick="nextMusic()" style="display:none;">
            <img src="icon/aumenta.png" onclick="volumeUp()">
            <img src="icon/diminuir.png" onclick="volumeDown()">
            <img id="muteBtn" src="icon/mute.png" onclick="toggleMute()">
            <img id="genreBtn" src="icon/genero.png" onclick="openGenres()" style="display:none;">
        </div>

        <div class="track-bar">
            <div class="track-info">
                <span id="trackName">Nenhuma m√∫sica</span>
                <span id="trackTime">00:00 / 00:00</span>
            </div>
            <div class="progress-container">
                <div class="progress" id="musicProgress"></div>
                <div class="dot" id="musicDot"></div>
            </div>
        </div>

        <div class="track-bar">
            <div class="track-info">
                <span>G√™nero: <b id="genreName">---</b></span>
                <span id="genreInfo">00:00:00 / 00:00:00</span>
            </div>
            <div class="progress-container">
                <div class="progress" id="genreProgress"></div>
                <div class="dot" id="genreDot"></div>
            </div>
        </div>
        
        <div class="track-bar">
            <div class="track-info">
                <span>Total Geral</span>
                <span id="globalInfo">00:00:00 / 00:00:00</span>
            </div>
            <div class="progress-container">
                <div class="progress" id="globalProgress"></div>
                <div class="dot" id="globalDot"></div>
            </div>
        </div>
    </div>
</div>

<div id="loginBox">
    <input id="user" placeholder="Usu√°rio">
    <input id="pass" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
</div>

<audio id="player"></audio>

<!-- =====================================================
JS
===================================================== -->
<script>

/* ===============================
VARI√ÅVEIS
================================ */
const player = document.getElementById("player");
const loginBox = document.getElementById("loginBox");
const loginIcon = document.getElementById("loginIcon");

const nextBtn = document.getElementById("nextBtn");
const genreBtn = document.getElementById("genreBtn");

const user = document.getElementById("user");
const pass = document.getElementById("pass");

let isAdmin = false;
let tempoTotalGenero = 0;
let tempoGeneroTocado = 0;

/* ===============================
LOGIN / LOGOUT
================================ */
function toggleLogin(){
    if(isAdmin){
        logout();
    }else{
        openLogin();
    }
}

function openLogin(){
    user.value = "";
    pass.value = "";
    loginBox.style.display = "flex";
}

function login(){
    if(user.value === "admin" && pass.value === "1234"){
        isAdmin = true;

        nextBtn.style.display = "block";
        genreBtn.style.display = "block";

        loginIcon.src = "icon/sair.png";
        loginBox.style.display = "none";

        user.value = "";
        pass.value = "";
    }else{
        alert("Usu√°rio ou senha inv√°lidos");
        pass.value = "";
    }
}

function logout(){
    isAdmin = false;

    nextBtn.style.display = "none";
    genreBtn.style.display = "none";

    loginIcon.src = "icon/login.png";
    loginBox.style.display = "none";

    user.value = "";
    pass.value = "";
}

/* ===============================
PLAYER
================================ */

let carregamentoIniciado = false;

function togglePlay(){

    // primeira intera√ß√£o do usu√°rio
    if(!carregamentoIniciado){
        carregamentoIniciado = true;
        calcularTempoGeral();
    }

    if(!player.src){
        iniciarRadio();
        playBtn.src = "icon/pause.png";
        playBtn.classList.add("active");
        return;
    }

    if(player.paused){
        player.play();
        playBtn.src = "icon/pause.png";
        playBtn.classList.add("active");
    }else{
        player.pause();
        playBtn.src = "icon/play.png";
        playBtn.classList.remove("active");
    }
}

function toggleMute(){
    player.muted = !player.muted;
}

function volumeUp(){ player.volume = Math.min(1, player.volume + 0.1); }
function volumeDown(){ player.volume = Math.max(0, player.volume - 0.1); }

function nextMusic(){
    player.dispatchEvent(new Event("ended"));
}

/* ===============================
L√ìGICA DE M√öSICAS
================================ */

const musicas = {
    "Eletronica": [
        "Amine_Edge_DANCE_Lost.mp3",
        "Azari_III_Hungry_for_the_power.mp3",
        "Maverick_Sabre_Slow_Down_Ft_Jorja_Smith_Vintage_Culture.mp3",
        "Tiesto_The_Business.mp3",
    ],
    "Sertanejo": [
        "Felipe_Rodrigo_Gosta_de_Rua.mp3",
        "Gusttavo_Lima_Bloqueado.mp3",
        "Henrique_e_Juliano_Flor_E_O_Beija_Flor_part_Mar√≠lia_Mendon√ßa.mp3",
        "Henrique_e_Juliano_VIDINHA_DE_BALADA.mp3",
        "Henrique_e_Juliano_VOLTA_POR_BAIXO.mp3",
        "Hugo_e_Guilherme_Mar√≠lia_Mendon√ßa_Mal_Feito.mp3",
        "Jorge_Mateus_CHEIROSA.mp3",
        "Lauana_Prado_Saudade_Burra_feat_Simone_Mendes.mp3",
        "Len√ßol_Dobrado_Jo√£o_Gustavo_e_Murilo.mp3",
        "Luiza_e_Maur√≠lio_S_de_Saudade_part_Z√©_Neto_e_Cristiano.mp3",
        "Maiara__Maraisa_Medo_Bobo.mp3",
        "Mar√≠lia_Mendon√ßa_BEBI_LIGUEI.mp3",
        "Mar√≠lia_Mendon√ßa_CIUMEIRA.mp3",
        "Mar√≠lia_Mendon√ßa_Eu_Sei_De_Cor.mp3",
        "Mar√≠lia_Mendon√ßa_INTEN√á√ÉO_feat_Gaab.mp3",
        "Mar√≠lia_Mendon√ßa_Le√£o.mp3",
        "Mar√≠lia_Mendon√ßa_TODO_MUNDO_VAI_SOFRER.mp3",
        "Matheus_Kauan_Decide_A√≠.mp3",
        "Matheus_Kauan_O_Nosso_Santo_Bateu.mp3",
        "Os_Bar√µes_da_Pisadinha_Esquema_Preferido.mp3",
        "Simone_Mendes_DOIS_TRISTES.mp3",
        "Simone_Mendes_Daqui_Pra_Sempre.mp3",
        "Simone_Mendes_Saudade_Proibida.mp3",
        "Tayrone_C√™_T√°_Preparada_ft_Mar√≠lia_Mendon√ßa.mp3",
        "Tudo_Que_Voc√™_Quiser_Luan_Santana.mp3",
        "Z√©_Neto_Cristiano_Barulho_do_Foguete.mp3",
        "Z√©_Neto_Cristiano_LARGADO_√ÄS_TRA√áAS.mp3",
        "Z√©_Neto_Cristiano_STATUS_QUE_EU_N√ÉO_QUERIA.mp3",
    ],
    "Pop": [
        "Artemas_I_like_the_way_you_kiss_me.mp3",
        "Calvin_Harris_Sam_Smith_Promises.mp3",
        "Calvin_Harris_Thinking_About_You_ft_Ayah_Marar.mp3",
        "Duke_Dumont_Ocean_Drive.mp3",
        "Ed_Sheeran_Bad_Habits.mp3",
        "Empire_of_the_Sun_We_Are_The_People.mp3",
        "Gorgon_City_Imagination_ft_Katy_Menditta.mp3",
        "I_Follow_Rivers_Lykke_Li.mp3",
        "James_Hype_7_Seconds_ft_Shamira_Battles.mp3",
        "James_Hype_Drums_ft_Kim_Petras.mp3",
        "James_Hype_Miggy_Dela_Rosa_Ferrari.mp3",
        "Kendrick_Lamar_SZA_All_The_Stars.mp3",
        "MEDUZA_Becky_Hill_Goodboys_Lose_Control.mp3",
        "MEDUZA_Tell_It_To_My_Heart_ft_Hozier.mp3",
        "Mr_Probz_Waves.mp3",
        "Purple_Disco_Machine_Kungs_Substitution_ft_Julian_Perretta.mp3",
        "Sam_Smith_Unholy_ft_Kim_Petras.mp3",
        "Tame_Impala_The_Less_I_Know_The_Better.mp3",
        "The_Black_Eyed_Peas_Meet_Me_Halfway.mp3",
        "Zerb_The_Chainsmokers_Addicted_ft_Ink.mp3",
    ],
    "Pagode": [
        "Bebe_Vem_Me_Procura_Quem_Ama_Sente_Saudade.mp3",
        "Grupo_Menos_E_Mais_Aquele_Lugar.mp3",
        "Grupo_Menos_E_Mais_Jejum_de_Amor.mp3",
        "Grupo_Menos_E_Mais_Nattan_Pela_Ultima_Vez.mp3",
        "Grupo_Menos_E_Mais_Simone_Mendes_P_do_Pecado.mp3",
        "Grupo_Menos_e_Mais_Tarde_Demais",
        "Grupo_Revelacao_Deixa_Acontecer.mp3",
        "Melhor_eu_ir_Ligando_os_Fatos.mp3",
        "Pixote_Inseguranca.mp3",
        "Turma_do_Pagode_A_Gente_Tem_Tudo_Ver.mp3",
        "Turma_do_Pagode_Deixa_em_Off.mp3",
     ],
    "Anos80": [
        "ABBA_Dancing_Queen.mp3",
        "AC_DC_Back_In_Black.mp3",
        "Alan_Jackson_Chattahoochee.mp3",
        "Culture_Club_Karma_Chameleon.mp3",
        "Cyndi_Lauper_Girls_Just_Want_To_Have_Fun.mp3",
        "Desireless_Voyage_Voyage.mp3",
        "Going_Back_West.mp3",
        "Guns_N_Roses_Sweet_Child_O_Mine.mp3",
        "Journey_Dont_Stop_Believin.mp3",
        "Joy_Touch_By_Touch.mp3",
        "Laura_Branigan_Self_Control.mp3",
        "Modern_Talking_Atlantis_Is_Calling.mp3",
        "Modern_Talking_Brother_Louie.mp3",
        "Modern_Talking_Cheri_Cheri_Lady.mp3",
        "Queen_I_Want_To_Break_Free.mp3",
        "Sweet_Dreams.mp3",
        "The_Outfield_Your_Love.mp3",
    ],
    "Divulgacao": [
        "promo1.mp3",
        "promo2.mp3",
        "promo3.mp3",
        "promo4.mp3",
        "promo5.mp3",
    ]
};

let generoAtual = "";
let musicasTocadas = [];
let contadorMusicas = 0;
let tocandoDivulgacao = false;
let musicaAtualNome = "";
let tempoTotalGeral = 0;
let tempoGeralTocado = 0;

const playBtn = document.getElementById("playBtn");

function iniciarRadio(){
    escolherGeneroAutomatico();
    tocarProxima();
}

function escolherGeneroAutomatico(){
    const generos = Object.keys(musicas).filter(g => g !== "Divulgacao");
    generoAtual = generos[Math.floor(Math.random() * generos.length)];
    musicasTocadas = [];
    contadorMusicas = 0;
    tempoGeneroTocado = 0;
    document.getElementById("genreProgress").style.width = "0%";
    document.getElementById("genreDot").style.left = "0%";
    document.getElementById("genreInfo").innerText = "00:00:00 / 00:00:00";
    document.getElementById("genreName").innerText = generoAtual;
    calcularTempoGenero(generoAtual);
}

function escolherGeneroManual(genero){
    closeGenrePanel();
    generoAtual = genero;
    musicasTocadas = [];
    contadorMusicas = 0;
    tempoGeneroTocado = 0;
    document.getElementById("genreProgress").style.width = "0%";
    document.getElementById("genreDot").style.left = "0%";
    document.getElementById("genreInfo").innerText = "00:00:00 / 00:00:00";
    document.getElementById("genreName").innerText = generoAtual;
    calcularTempoGenero(generoAtual);
}

function tocarProxima(){

    if(musicasTocadas.length === musicas[generoAtual].length){
        escolherGeneroAutomatico();
    }

    let musica;
    do{
        musica = musicas[generoAtual][Math.floor(Math.random() * musicas[generoAtual].length)];
    }while(musicasTocadas.includes(musica));

    musicasTocadas.push(musica);
    tocarMusica(generoAtual, musica);
}

function tocarMusica(genero, arquivo){
    musicaAtualNome = arquivo
        .replace(/_/g," ")
        .replace(".mp3","");

    document.getElementById("trackName").innerText = "Carregando...";

    player.src = `musicas/${genero}/${arquivo}`;
    player.load();
    player.play();

    playBtn.src = "icon/pause.png";
}

player.addEventListener("timeupdate", () => {
    if(!player.duration) return;
    const pct = ((player.currentTime || 0) / player.duration) * 100;
    document.getElementById("musicProgress").style.width = pct + "%";
    document.getElementById("musicDot").style.left = pct + "%";
    document.getElementById("trackTime").innerText =
        formatar(player.currentTime) + " / " + formatar(player.duration);

if(tempoTotalGenero > 0){
    const totalTocado = tempoGeneroTocado + (player.currentTime || 0);
    const pctGenero = (totalTocado / tempoTotalGenero) * 100;

    document.getElementById("genreProgress").style.width =
        Math.min(pctGenero, 100) + "%";

    document.getElementById("genreDot").style.left =
        Math.min(pctGenero, 100) + "%";

    document.getElementById("genreInfo").innerText =
        formatarHMS(totalTocado) + " / " + formatarHMS(tempoTotalGenero);
}

if(tempoTotalGeral > 0){
    const totalGeral = tempoGeralTocado + (player.currentTime || 0);
    const pctGeral = (totalGeral / tempoTotalGeral) * 100;

    document.getElementById("globalProgress").style.width =
        Math.min(pctGeral,100) + "%";

    document.getElementById("globalDot").style.left =
        Math.min(pctGeral,100) + "%";

    document.getElementById("globalInfo").innerText =
        formatarHMS(totalGeral) + " / " + formatarHMS(tempoTotalGeral);
}

});
 
function tocarDivulgacao(){
    const lista = musicas["Divulgacao"];
    if(!lista || lista.length === 0){
        tocarProxima();
        return;
    }

    tocandoDivulgacao = true;
    const promo = lista[Math.floor(Math.random() * lista.length)];
    tocarMusica("Divulgacao", promo);
}

function formatar(t){
    const m = Math.floor(t / 60).toString().padStart(2,"0");
    const s = Math.floor(t % 60).toString().padStart(2,"0");
    return `${m}:${s}`;
}

function formatarHMS(t){
    const h = Math.floor(t / 3600).toString().padStart(2,"0");
    const m = Math.floor((t % 3600) / 60).toString().padStart(2,"0");
    const s = Math.floor(t % 60).toString().padStart(2,"0");
    return `${h}:${m}:${s}`;
}

/* ===============================
JS PAINEL DE G√äNEROS
================================ */

const genrePanel = document.getElementById("genrePanel");
const genreList = document.getElementById("genreList");

function openGenres(){
    if(!isAdmin) return;

    genreList.innerHTML = "";

    Object.keys(musicas).forEach(genero=>{
        if(genero === "Divulgacao") return;

        const btn = document.createElement("button");
        btn.innerText = genero;
        btn.onclick = ()=> escolherGeneroManual(genero);
        genreList.appendChild(btn);
    });

    genrePanel.style.display = "flex";
}

function closeGenrePanel(){
    genrePanel.style.display = "none";
}

function escolherGeneroManual(genero){
    closeGenrePanel();
    generoAtual = genero;
    musicasTocadas = [];
    contadorMusicas = 0;
    tempoGeneroTocado = 0;
    tempoGeralTocado = 0;
    document.getElementById("genreProgress").style.width = "0%";
    document.getElementById("genreDot").style.left = "0%";
    document.getElementById("genreInfo").innerText = "00:00:00 / 00:00:00";
    document.getElementById("globalProgress").style.width = "0%";
    document.getElementById("globalDot").style.left = "0%";
    document.getElementById("globalInfo").innerText = "00:00:00 / 00:00:00";
    tocandoDivulgacao = false;
    document.getElementById("genreName").innerText = generoAtual;
    calcularTempoGenero(generoAtual);
    tocarProxima();
}

player.addEventListener("ended", () => {

    if(!tocandoDivulgacao){
    const dur = player.duration || 0;

    tempoGeneroTocado += dur;
    tempoGeralTocado += dur;

    contadorMusicas++
    }

    if(tocandoDivulgacao){
        tocandoDivulgacao = false;
        tocarProxima();
        return;
    }

    if(contadorMusicas > 0 && contadorMusicas % 5 === 0){
        tocarDivulgacao();
        return;
    }

    tocarProxima();
});

function autoGenre(){
    closeGenrePanel();
    escolherGeneroAutomatico();
    tocarProxima();
}

/* ===============================
ESTADOS VISUAIS
================================ */

/* ELEMENTOS */
const playBtnEl = document.getElementById("playBtn");
const muteBtnEl = document.getElementById("muteBtn");
const loginBtnEl = document.getElementById("loginIcon");

/* MUTE VISUAL */
const originalMute = toggleMute;
toggleMute = function(){
    originalMute();

    if(player.muted){
        muteBtnEl.classList.add("active");
        muteBtnEl.src = "icon/volume.png";
    }else{
        muteBtnEl.classList.remove("active");
        muteBtnEl.src = "icon/mute.png";
    }
};

/* LOGIN / LOGOUT VISUAL */
const originalLogin = login;
login = function(){
    originalLogin();
    if(isAdmin){
        loginBtnEl.classList.add("active");
    }
};

const originalLogout = logout;
logout = function(){
    originalLogout();
    loginBtnEl.classList.remove("active");
};

function calcularTempoGenero(genero){
    tempoTotalGenero = 0;

    const lista = musicas[genero];
    let processadas = 0;

    if(!lista || lista.length === 0){
    document.getElementById("genreInfo").innerText = "00:00:00 / 00:00:00";
    document.getElementById("genreProgress").style.width = "0%";
    document.getElementById("genreDot").style.left = "0%";
    return;
}

    lista.forEach(musica=>{
        const audioTemp = new Audio(`musicas/${genero}/${musica}`);

        const finalizar = ()=>{
            processadas++;
            if(processadas === lista.length){
                document.getElementById("genreInfo").innerText =
                        "00:00:00 / " + formatarHMS(tempoTotalGenero);
            }
        };

        audioTemp.addEventListener("loadedmetadata", ()=>{
            if(!isNaN(audioTemp.duration)){
                tempoTotalGenero += audioTemp.duration;
            }
            finalizar();
        });

        audioTemp.addEventListener("error", ()=>{
            console.warn("Erro ao carregar:", musica);
            finalizar();
        });
    });
}

function calcularTempoGeral(){

    const loadingPanel = document.getElementById("loadingPanel");
    const loadingList = document.getElementById("loadingList");
    const loadingProgress = document.getElementById("loadingProgress");
    const loadingPercent = document.getElementById("loadingPercent");

    loadingPanel.style.display = "flex";
    loadingList.innerHTML = "";

    tempoTotalGeral = 0;

    const generos = Object.keys(musicas).filter(g=>g!=="Divulgacao");

    let totalArquivos = 0;
    let carregados = 0;

    // controle por g√™nero
    const contagemGenero = {};
    const totalPorGenero = {};

    generos.forEach(g=>{
        contagemGenero[g] = 0;
        totalPorGenero[g] = musicas[g].length;

        const div = document.createElement("div");
        div.className = "loading-item";
        div.innerHTML = `<span>${g}</span><span id="status-${g}">‚è≥</span>`;
        loadingList.appendChild(div);

        totalArquivos += musicas[g].length;
    });

    generos.forEach(genero=>{
        musicas[genero].forEach(musica=>{

            const audio = new Audio(`musicas/${genero}/${musica}`);

            const finalizar = ()=>{

                carregados++;
                contagemGenero[genero]++;

                const pct = Math.floor((carregados / totalArquivos) * 100);
                loadingProgress.style.width = pct + "%";
                loadingPercent.innerText = pct + "%";

                // quando g√™nero termina
                if(contagemGenero[genero] === totalPorGenero[genero]){
                    document.getElementById("status-"+genero).innerText = "‚úÖ";
                }

                // quando tudo termina
                if(carregados === totalArquivos){
                    loadingPanel.style.display = "none";
                    document.getElementById("globalInfo").innerText =
                        "00:00:00 / " + formatarHMS(tempoTotalGeral);
                }
            };

            audio.addEventListener("loadedmetadata", ()=>{
                if(!isNaN(audio.duration)){
                    tempoTotalGeral += audio.duration;
                }
                finalizar();
            });

            audio.addEventListener("error", ()=>{
                finalizar();
            });

        });
    });
}


/* ===============================
BARRA DE CARREGAMENTO (BUFFER)
================================ */

player.addEventListener("loadstart", () => {
    document.getElementById("musicProgress").style.width = "0%";
    document.getElementById("musicDot").style.left = "0%";
});

player.addEventListener("progress", () => {
    if(player.buffered.length > 0 && player.duration){
        const bufferedEnd = player.buffered.end(0);
        const pct = Math.min((bufferedEnd / player.duration) * 100, 100);

        document.getElementById("musicProgress").style.width = pct + "%";
        document.getElementById("musicDot").style.left = pct + "%";
    }
});

player.addEventListener("canplay", () => {
    // mant√©m o pause/play correto
    playBtn.src = "icon/pause.png";
});

/* ===============================
MOSTRAR NOME DA M√öSICA AO TOCAR
================================ */

player.addEventListener("playing", () => {
    if(musicaAtualNome){
        document.getElementById("trackName").innerText = musicaAtualNome;
    }
});

</script>
</body>
</html>
