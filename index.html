<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>R√°dio Online</title>

<!-- =====================================================
CSS
===================================================== -->
<style>

/* ===============================
RESET E BASE
================================ */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    background:#111;
    color:#fff;
    font-family:Arial, Helvetica, sans-serif;
    min-height:100vh;
    padding-top:70px;
    padding-bottom:120px;
}

/* ===============================
BARRA SUPERIOR FIXA
================================ */
.top-bar{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:70px;
    background:linear-gradient(90deg,#007bff,#ff7a00);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 20px;
    z-index:1000;
}

.top-bar img{
    height:40px;
    cursor:pointer;
}

/* ===============================
√ÅREA CENTRAL
================================ */
.center{
    max-width:1200px;
    margin:0 auto;
    text-align:center;
    padding:60px 20px;
}

/* ===============================
BARRA INFERIOR FIXA
================================ */
.bottom-bar{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    height:120px;
    background:#000;
    border-top:1px solid #222;
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:1000;
}

/* ===============================
PLAYER WRAPPER
================================ */
.player-wrapper{
    width:100%;
    max-width:1200px;
    display:flex;
    align-items:center;
    gap:15px;
    padding:0 15px;
}

/* ===============================
BOT√ïES
================================ */
.controls{
    display:flex;
    gap:10px;
}

.controls img{
    width:42px;
    height:42px;
    cursor:pointer;
    opacity:.7;
    transition:.2s;
}

.controls img:hover{
    opacity:1;
    transform:scale(1.1);
    filter:drop-shadow(0 0 6px #00c3ff);
}

/* ===============================
BARRAS (M√öSICA / G√äNERO)
================================ */
.track-bar{
    flex:1;
    background:#1b1b1b;
    border-radius:14px;
    padding:10px 14px;
    height:70px;
    display:flex;
    flex-direction:column;
    justify-content:center;
}

.track-info{
    display:flex;
    justify-content:space-between;
    font-size:13px;
    margin-bottom:6px;
}

.progress-container{
    position:relative;
    height:7px;
    background:#333;
    border-radius:6px;
    overflow:hidden;
}

.progress{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#00c3ff,#ff7a00);
}

.dot{
    position:absolute;
    top:50%;
    left:0%;
    width:12px;
    height:12px;
    background:#fff;
    border-radius:50%;
    transform:translate(-50%,-50%);
}

/* ===============================
LOGIN BOX
================================ */
#loginBox{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:#1c1c1c;
    padding:20px;
    border-radius:10px;
    display:none;
    flex-direction:column;
    gap:10px;
    z-index:2000;
}

#loginBox input{
    padding:10px;
    border:none;
    border-radius:6px;
}

#loginBox button{
    padding:10px;
    background:#ff7a00;
    border:none;
    color:#fff;
    border-radius:6px;
    cursor:pointer;
}

/* ===============================
RESPONSIVO
================================ */
@media(max-width:768px){
    .player-wrapper{
        flex-direction:column;
    }
    .track-bar{
        width:100%;
    }
}

/* ===============================
PARTE 13 ‚Äì CSS PAINEL DE G√äNEROS
================================ */
#genrePanel{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.75);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:3000;
}

.genre-box{
    background:#1c1c1c;
    padding:20px;
    border-radius:12px;
    width:90%;
    max-width:320px;
    display:flex;
    flex-direction:column;
    gap:10px;
    text-align:center;
}

#genreList button{
    padding:10px;
    border:none;
    border-radius:6px;
    background:#007bff;
    color:#fff;
    cursor:pointer;
}

#genreList button:hover{
    background:#ff7a00;
}

/* ===============================
PARTE 14 ‚Äì ANIMA√á√ïES DOS BOT√ïES
================================ */

.controls img{
    transition:
        transform .2s ease,
        filter .2s ease,
        opacity .2s ease;
}

/* Hover */
.controls img:hover{
    transform:scale(1.15);
    filter:drop-shadow(0 0 8px rgba(0,195,255,.8));
    opacity:1;
}

/* Ativo */
.controls img.active{
    filter:drop-shadow(0 0 10px rgba(255,122,0,.9));
    transform:scale(1.15);
    opacity:1;
}

/* Clique */
.controls img:active{
    transform:scale(0.95);
}

</style>
</head>

<!-- ===============================
PARTE 13 ‚Äì PAINEL DE G√äNEROS
================================ -->
<div id="genrePanel" style="display:none">
    <div class="genre-box">
        <h3>Selecionar G√™nero</h3>

        <div id="genreList"></div>

        <button onclick="autoGenre()">üîÄ Sele√ß√£o Autom√°tica</button>
        <button onclick="closeGenrePanel()">‚ùå Fechar</button>
    </div>
</div>

<body>

<!-- =====================================================
HTML
===================================================== -->

<!-- BARRA SUPERIOR -->
<div class="top-bar">
    <img src="imagens/logo.png" alt="Logo">
    <img id="loginIcon" src="icon/login.png" onclick="toggleLogin()">
</div>

<!-- CONTE√öDO CENTRAL -->
<div class="center">
    <h1>R√°dio Online</h1>
    <p>Pinheirinho Celulares</p>
</div>

<!-- BARRA INFERIOR -->
<div class="bottom-bar">
    <div class="player-wrapper">

        <!-- BOT√ïES -->
        <div class="controls">
            <img id="playBtn" src="icon/play.png" onclick="togglePlay()">
            <img id="nextBtn" src="icon/proximo.png" onclick="nextMusic()" style="display:none;">
            <img src="icon/aumenta.png" onclick="volumeUp()">
            <img src="icon/diminuir.png" onclick="volumeDown()">
            <img id="muteBtn" src="icon/mute.png" onclick="toggleMute()">
            <img id="genreBtn" src="icon/genero.png" onclick="openGenres()" style="display:none;">
        </div>

        <!-- BARRA DA M√öSICA -->
        <div class="track-bar">
            <div class="track-info">
                <span id="trackName">Nenhuma m√∫sica</span>
                <span id="trackTime">00:00 / 00:00</span>
            </div>
            <div class="progress-container">
                <div class="progress" id="musicProgress"></div>
                <div class="dot" id="musicDot"></div>
            </div>
        </div>

        <!-- BARRA DO G√äNERO -->
        <div class="track-bar">
            <div class="track-info">
                <span>G√™nero: <b id="genreName">---</b></span>
                <span id="genreInfo">00:00:00</span>
            </div>
            <div class="progress-container">
                <div class="progress" id="genreProgress"></div>
                <div class="dot" id="genreDot"></div>
            </div>
        </div>

    </div>
</div>

<!-- LOGIN -->
<div id="loginBox">
    <input id="user" placeholder="Usu√°rio">
    <input id="pass" type="password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
</div>

<audio id="player"></audio>

<!-- =====================================================
JS
===================================================== -->
<script>

/* ===============================
VARI√ÅVEIS
================================ */
const player = document.getElementById("player");
const loginBox = document.getElementById("loginBox");
const loginIcon = document.getElementById("loginIcon");

const nextBtn = document.getElementById("nextBtn");
const genreBtn = document.getElementById("genreBtn");

const user = document.getElementById("user");
const pass = document.getElementById("pass");

let isAdmin = false;

/* ===============================
LOGIN / LOGOUT
================================ */
function toggleLogin(){
    if(isAdmin){
        logout();
    }else{
        openLogin();
    }
}

function openLogin(){
    user.value = "";
    pass.value = "";
    loginBox.style.display = "flex";
}

function login(){
    if(user.value === "admin" && pass.value === "1234"){
        isAdmin = true;

        nextBtn.style.display = "block";
        genreBtn.style.display = "block";

        loginIcon.src = "icon/sair.png";
        loginBox.style.display = "none";

        user.value = "";
        pass.value = "";
    }else{
        alert("Usu√°rio ou senha inv√°lidos");
        pass.value = "";
    }
}

function logout(){
    isAdmin = false;

    nextBtn.style.display = "none";
    genreBtn.style.display = "none";

    loginIcon.src = "icon/login.png";
    loginBox.style.display = "none";

    user.value = "";
    pass.value = "";
}

/* ===============================
PLAYER
================================ */
function togglePlay(){
    if(player.paused){
        player.play();
        playBtn.src="icon/pause.png";
    }else{
        player.pause();
        playBtn.src="icon/play.png";
    }
}

function toggleMute(){
    player.muted = !player.muted;
    muteBtn.src = player.muted ? "icon/volume.png" : "icon/mute.png";
}

function volumeUp(){ player.volume = Math.min(1, player.volume + 0.1); }
function volumeDown(){ player.volume = Math.max(0, player.volume - 0.1); }

function nextMusic(){
    player.dispatchEvent(new Event("ended"));
}

function openGenres(){
    alert("Painel de g√™neros ‚Äì pr√≥xima etapa");
}

/* ===============================
PARTE 12 ‚Äì L√ìGICA DE M√öSICAS
================================ */

/* ===== ESTRUTURA DAS M√öSICAS ===== */
const musicas = {
    "Eletronica": [
        "musica1.mp3",
        "musica2.mp3"
    ],
    "Sertanejo": [
        "musica1.mp3",
        "musica2.mp3"
    ],
    "Pop": [
        "musica1.mp3",
        "musica2.mp3"
    ],
    "Pagode": [
        "musica1.mp3",
        "musica2.mp3"
    ],
    "Anos 80": [
        "musica1.mp3",
        "musica2.mp3"
    ],
    "Divulgacao": [
        "promo1.mp3",
        "promo2.mp3"
    ]
};

/* ===== CONTROLE ===== */
let generoAtual = "";
let musicasTocadas = [];
let contadorMusicas = 0;
let tocandoDivulgacao = false;

/* ===== INICIAR PLAY ===== */
const playBtn = document.getElementById("playBtn");

function iniciarRadio(){
    escolherGeneroAutomatico();
    tocarProxima();
}

/* ===== G√äNERO AUTOM√ÅTICO ===== */
function escolherGeneroAutomatico(){
    const generos = Object.keys(musicas).filter(g => g !== "Divulgacao");
    generoAtual = generos[Math.floor(Math.random() * generos.length)];
    musicasTocadas = [];
    contadorMusicas = 0;

    document.getElementById("genreName").innerText = generoAtual;
}

/* ===== TOCAR PR√ìXIMA ===== */
function tocarProxima(){

    if(musicasTocadas.length === musicas[generoAtual].length){
        escolherGeneroAutomatico();
    }

    let musica;
    do{
        musica = musicas[generoAtual][Math.floor(Math.random() * musicas[generoAtual].length)];
    }while(musicasTocadas.includes(musica));

    musicasTocadas.push(musica);
    tocarMusica(generoAtual, musica);
}

/* ===== TOCAR M√öSICA ===== */
function tocarMusica(genero, arquivo){
    player.src = `musicas/${genero}/${arquivo}`;
    player.play();

    document.getElementById("trackName").innerText =
        arquivo.replace(/_/g," ").replace(".mp3","");

    playBtn.src = "icon/pause.png";
}

/* ===== EVENTO FIM ===== */
player.addEventListener("ended", () => {

    if(tocandoDivulgacao){
        tocandoDivulgacao = false;
        tocarProxima();
        return;
    }

    contadorMusicas++;

    if(contadorMusicas % 5 === 0){
        tocarDivulgacao();
    }else{
        tocarProxima();
    }
});

/* ===== DIVULGA√á√ÉO ===== */
function tocarDivulgacao(){
    const lista = musicas["Divulgacao"];
    if(!lista || lista.length === 0){
        tocarProxima();
        return;
    }

    tocandoDivulgacao = true;
    const promo = lista[Math.floor(Math.random() * lista.length)];
    tocarMusica("Divulgacao", promo);
}

/* ===== BARRAS ===== */
player.addEventListener("timeupdate", () => {

    if(!player.duration) return;

    const pct = (player.currentTime / player.duration) * 100;

    document.getElementById("musicProgress").style.width = pct + "%";
    document.getElementById("musicDot").style.left = pct + "%";

    document.getElementById("trackTime").innerText =
        formatar(player.currentTime) + " / " + formatar(player.duration);

    const total = musicas[generoAtual].length;
    const atual = musicasTocadas.length;

    document.getElementById("genreInfo").innerText =
        atual + " / " + total;
    document.getElementById("genreProgress").style.width =
        (atual / total) * 100 + "%";
    document.getElementById("genreDot").style.left =
        (atual / total) * 100 + "%";
});

/* ===== FORMATO TEMPO ===== */
function formatar(t){
    const m = Math.floor(t / 60).toString().padStart(2,"0");
    const s = Math.floor(t % 60).toString().padStart(2,"0");
    return `${m}:${s}`;
}

/* ===== PRIMEIRO PLAY ===== */
const oldTogglePlay = togglePlay;
togglePlay = function(){
    if(!player.src){
        iniciarRadio();
    }else{
        oldTogglePlay();
    }
};

/* ===============================
PARTE 13 ‚Äì JS PAINEL DE G√äNEROS
================================ */

const genrePanel = document.getElementById("genrePanel");
const genreList = document.getElementById("genreList");

/* ABRIR PAINEL */
function openGenres(){
    if(!isAdmin) return;

    genreList.innerHTML = "";

    Object.keys(musicas).forEach(genero=>{
        if(genero === "Divulgacao") return;

        const btn = document.createElement("button");
        btn.innerText = genero;
        btn.onclick = ()=> escolherGeneroManual(genero);
        genreList.appendChild(btn);
    });

    genrePanel.style.display = "flex";
}

/* FECHAR */
function closeGenrePanel(){
    genrePanel.style.display = "none";
}

/* ESCOLHA MANUAL */
function escolherGeneroManual(genero){
    generoAtual = genero;
    musicasTocadas = [];
    contadorMusicas = 0;
    tocandoDivulgacao = false;

    document.getElementById("genreName").innerText = generoAtual;

    closeGenrePanel();
    tocarProxima();
}

/* AUTOM√ÅTICO */
function autoGenre(){
    closeGenrePanel();
    escolherGeneroAutomatico();
    tocarProxima();
}

/* ===============================
PARTE 14 ‚Äì ESTADOS VISUAIS
================================ */

/* ELEMENTOS */
const playBtnEl = document.getElementById("playBtn");
const muteBtnEl = document.getElementById("muteBtn");
const loginBtnEl = document.getElementById("loginIcon");

/* PLAY / PAUSE VISUAL */
const originalTogglePlay = togglePlay;
togglePlay = function(){
    originalTogglePlay();

    if(!player.paused){
        playBtnEl.classList.add("active");
        playBtnEl.src = "icon/pause.png";
    }else{
        playBtnEl.classList.remove("active");
        playBtnEl.src = "icon/play.png";
    }
};

/* MUTE VISUAL */
const originalMute = toggleMute;
toggleMute = function(){
    originalMute();

    if(player.muted){
        muteBtnEl.classList.add("active");
        muteBtnEl.src = "icon/volume.png";
    }else{
        muteBtnEl.classList.remove("active");
        muteBtnEl.src = "icon/mute.png";
    }
};

/* LOGIN / LOGOUT VISUAL */
const originalLogin = login;
login = function(){
    originalLogin();
    if(isAdmin){
        loginBtnEl.classList.add("active");
    }
};

const originalLogout = logout;
logout = function(){
    originalLogout();
    loginBtnEl.classList.remove("active");
};

</script>
</body>
</html>
